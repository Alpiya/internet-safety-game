```html
<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–í–µ–±-–∏–≥—Ä–∞: –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç</title>
  <style>
    :root{
      --bg:#0f1221;
      --text:#f2f4ff;
      --muted:#b8bce6;
      --accent:#7c5cff;
      --good:#3bd27d;
      --bad:#ff5c7a;
    }
    *{box-sizing:border-box}

    /* üî• –¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ö–ò–ë–ï–†-–§–û–ù + ‚Äú–î–´–•–ê–ù–ò–ï‚Äù */
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 10% 10%, rgba(124,92,255,.25), transparent 60%),
        radial-gradient(800px 500px at 90% 20%, rgba(79,213,255,.18), transparent 60%),
        linear-gradient(180deg, #0b1024, #0f1221 60%, #0b1024);
      background-size: 200% 200%;
      animation: bgMove 25s ease infinite;
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    @keyframes bgMove{
      0%{ background-position: 0% 50%; }
      50%{ background-position: 100% 50%; }
      100%{ background-position: 0% 50%; }
    }

    .app{ width:min(980px, 100%); }

    header{
      display:flex;
      gap:14px;
      align-items:flex-end;
      justify-content:space-between;
      margin-bottom:14px;
      flex-wrap:wrap;
    }
    .title h1{
      font-size:22px;
      margin:0 0 4px 0;
      letter-spacing:.2px;
    }
    .title p{
      margin:0;
      color:var(--muted);
      font-size:14px;
    }

    .stats{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }
    .pill{
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      border-radius:999px;
      padding:8px 12px;
      font-size:13px;
      color:var(--muted);
      display:flex;
      gap:8px;
      align-items:center;
      white-space:nowrap;
    }
    .pill strong{color:var(--text); font-weight:900}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(255,255,255,.12);
      border-radius:16px;
      padding:18px;
      box-shadow: 0 14px 40px rgba(0,0,0,.35);
      backdrop-filter: blur(8px);
      animation: fadeIn .4s ease;
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute;
      inset:-40px;
      background:
        radial-gradient(420px 220px at 20% 20%, rgba(124,92,255,.12), transparent 60%),
        radial-gradient(420px 220px at 80% 10%, rgba(79,213,255,.10), transparent 60%),
        radial-gradient(420px 220px at 70% 80%, rgba(59,210,125,.08), transparent 60%);
      pointer-events:none;
    }
    .card > *{ position:relative; }

    @keyframes fadeIn{
      from{opacity:0; transform:translateY(6px)}
      to{opacity:1; transform:translateY(0)}
    }

    .progress{
      height:10px;
      background: rgba(255,255,255,.07);
      border-radius:999px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.09);
      margin-bottom:14px;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--accent), #4fd5ff);
      transition: width .25s ease;
    }

    .qno{
      color:var(--muted);
      font-size:13px;
      margin-bottom:10px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }

    /* –ò–∫–æ–Ω–∫–∞ –≤–æ–ø—Ä–æ—Å–∞ */
    #qIcon{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      width:44px;
      height:44px;
      font-size:30px;
      border-radius:14px;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      box-shadow: 0 10px 26px rgba(0,0,0,.25);
    }

    .question{
      font-size:18px;
      line-height:1.35;
      margin:10px 0 14px 0;
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    button{
      border:0;
      cursor:pointer;
      border-radius:12px;
      padding:12px 14px;
      font-weight:900;
      color:var(--text);
      background: rgba(255,255,255,.07);
      border:1px solid rgba(255,255,255,.12);
      transition: transform .05s ease, background .2s ease, border .2s ease, filter .2s ease;
      user-select:none;
    }
    button:hover{ filter: brightness(1.08); }
    button:active{transform: translateY(1px)}
    button.primary{
      background: linear-gradient(90deg, var(--accent), #4fd5ff);
      border-color: transparent;
      color: #0b0e1a;
    }
    button.truth{background: rgba(59,210,125,.14); border-color: rgba(59,210,125,.35)}
    button.fake{background: rgba(255,92,122,.14); border-color: rgba(255,92,122,.35)}
    button.warn{background: rgba(255,200,90,.10); border-color: rgba(255,200,90,.35)}
    button:disabled{opacity:.55; cursor:not-allowed}

    /* –ò–≥—Ä–æ–≤—ã–µ –º–∞—Ä–∫–µ—Ä—ã –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö */
    button.truth::before{ content:"‚úî "; font-weight:900; }
    button.fake::before{ content:"‚úñ "; font-weight:900; }

    /* ‚úÖ‚ùå –í–ò–ó–£–ê–õ–¨–ù–ê–Ø –†–ï–ê–ö–¶–ò–Ø –ü–†–ò –û–¢–í–ï–¢–ï */
    .card.correct{ animation: flashGood .45s ease; }
    .card.wrong{ animation: flashBad .45s ease; }

    @keyframes flashGood{
      0%{ box-shadow: 0 0 0 rgba(59,210,125,0); }
      50%{ box-shadow: 0 0 30px rgba(59,210,125,.8); }
      100%{ box-shadow: 0 0 0 rgba(59,210,125,0); }
    }
    @keyframes flashBad{
      0%{ box-shadow: 0 0 0 rgba(255,92,122,0); }
      50%{ box-shadow: 0 0 30px rgba(255,92,122,.8); }
      100%{ box-shadow: 0 0 0 rgba(255,92,122,0); }
    }

    .feedback{
      margin-top:12px;
      padding:12px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.10);
      display:none;
      background: rgba(255,255,255,.05);
    }
    .feedback.show{display:block}
    .feedback.good{border-color: rgba(59,210,125,.40); background: rgba(59,210,125,.10)}
    .feedback.bad{border-color: rgba(255,92,122,.40); background: rgba(255,92,122,.10)}
    .feedback .label{
      font-weight:900;
      margin-bottom:6px;
    }

    /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ –∫–∞–∫ ‚Äú–ø—Ä–∞–≤–∏–ª–æ‚Äù */
    .hint{
      display:none;
      margin-top:14px;
      padding:12px;
      border-radius:10px;
      background: linear-gradient(90deg, rgba(124,92,255,.15), rgba(79,213,255,.12));
      border-left:4px solid var(--accent);
      color: rgba(242,244,255,.92);
      font-size:14px;
    }
    .hint.show{display:block}
    .hint strong{ color: rgba(242,244,255,.98); }

    .footer{
      margin-top:12px;
      display:flex;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      color:var(--muted);
      font-size:12px;
    }
    .kbd{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
      padding:2px 7px;
      border-radius:8px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.25);
      color: var(--text);
      font-size:12px;
    }

    /* END */
    .end{ display:none; text-align:center; }
    .end.show{display:block}
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:6px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      font-weight:900;
    }

    /* –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç */
    #certWrap{
      display:none;
      margin-top:14px;
      text-align:center;
    }
    #certWrap.show{display:block}
    #certCanvas{
      width:min(900px, 100%);
      height:auto;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 16px 60px rgba(0,0,0,.45);
      background: rgba(0,0,0,.15);
    }
    .certBtns{
      display:flex;
      gap:10px;
      justify-content:center;
      flex-wrap:wrap;
      margin-top:10px;
    }

    /* TEACHER MODAL */
    .modalBack{
      position:fixed; inset:0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
    }
    .modalBack.show{display:flex}
    .modal{
      width:min(980px, 100%);
      max-height: 88vh;
      overflow:auto;
      border-radius:16px;
      padding:16px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.04));
      border:1px solid rgba(255,255,255,.12);
      box-shadow: 0 16px 60px rgba(0,0,0,.5);
      text-align:left;
    }
    .modal h3{ margin:0 0 10px 0; }
    label{ display:block; font-size:13px; color:var(--muted); margin-bottom:6px; }
    input{
      width:100%;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: var(--text);
      outline: none;
    }
    .table{
      width:100%;
      border-collapse: collapse;
      margin-top:10px;
      font-size:13px;
    }
    .table th, .table td{
      border-bottom:1px solid rgba(255,255,255,.10);
      padding:10px 8px;
      vertical-align:top;
    }
    .table th{ text-align:left; color:var(--muted); font-weight:900; }
    .tag{
      display:inline-flex;
      padding:2px 8px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      font-weight:900;
      font-size:12px;
    }
    .tag.good{ border-color: rgba(59,210,125,.35); background: rgba(59,210,125,.10); }
    .tag.bad{ border-color: rgba(255,92,122,.35); background: rgba(255,92,122,.10); }
    .small{ font-size:12px; color:var(--muted); line-height:1.4; }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <h1>–í–µ–±-–∏–≥—Ä–∞ ¬´–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç¬ª</h1>
        <p>–¢–µ–º–∞ 1 ‚Ä¢ 8‚Äì11 –∫–ª–∞—Å—Å—ã ‚Ä¢ –æ—Ç–≤–µ—á–∞–π ¬´–ü—Ä–∞–≤–¥–∞ / –§–µ–π–∫¬ª</p>
      </div>
      <div class="stats">
        <div class="pill">–í–æ–ø—Ä–æ—Å: <strong id="statQ">1/10</strong></div>
        <div class="pill">–°—á—ë—Ç: <strong id="statScore">0</strong></div>
        <button class="warn" id="btnTeacher" title="–û—Ç–≤–µ—Ç—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ">–†–µ–∂–∏–º —É—á–∏—Ç–µ–ª—è</button>
      </div>
    </header>

    <!-- –≠–∫—Ä–∞–Ω –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏ (–æ–¥–∏–Ω —Ä–∞–∑ –≤ –Ω–∞—á–∞–ª–µ) -->
    <div class="card" id="nameCard">
      <div class="qno">
        <div><b>–í–≤–µ–¥–∏—Ç–µ –∏–º—è —É—á–∞—Å—Ç–Ω–∏–∫–∞</b></div>
        <div id="qIcon" aria-hidden="true">üßë‚Äçüéì</div>
      </div>
      <p class="question" style="margin-top:0">
        –ò–º—è –±—É–¥–µ—Ç –Ω–∞–ø–µ—á–∞—Ç–∞–Ω–æ –Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–µ –≤ –∫–æ–Ω—Ü–µ –∏–≥—Ä—ã.
      </p>
      <div class="controls">
        <input id="nameInput" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–ª–∏—è" style="max-width:340px">
        <button class="primary" id="btnStart">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
      </div>
      <div class="small" style="margin-top:10px">
        –ü–æ–¥—Å–∫–∞–∑–∫–∞: –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ê–π—Å—É–ª—É –ù.¬ª).
      </div>
    </div>

    <!-- –ò–≥—Ä–∞ -->
    <div class="card" id="gameCard" style="display:none;">
      <div class="progress" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å">
        <div class="bar" id="bar"></div>
      </div>

      <div class="qno">
        <div id="qno">–í–æ–ø—Ä–æ—Å 1 –∏–∑ 10</div>
        <div id="qIconQ" aria-hidden="true">üîê</div>
      </div>

      <p class="question" id="question">–ó–∞–≥—Ä—É–∑–∫–∞‚Ä¶</p>

      <div class="controls">
        <button class="truth" id="btnTruth">–ü—Ä–∞–≤–¥–∞</button>
        <button class="fake" id="btnFake">–§–µ–π–∫</button>
        <button id="btnSkip" title="–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤–æ–ø—Ä–æ—Å">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å</button>
      </div>

      <div class="feedback" id="feedback">
        <div class="label" id="fbLabel"></div>
        <div id="fbText"></div>
      </div>

      <div class="hint" id="hint">
        <strong>–ü–æ–¥—Å–∫–∞–∑–∫–∞-–ø—Ä–∞–≤–∏–ª–æ:</strong>
        <span id="hintText"></span>
      </div>

      <div class="controls" style="justify-content:flex-end; margin-top:14px;">
        <button class="primary" id="btnNext" disabled>–î–∞–ª—å—à–µ ‚Üí</button>
      </div>

      <div class="footer">
        <div>–ö–ª–∞–≤–∏—à–∏: <span class="kbd">T</span> –ø—Ä–∞–≤–¥–∞, <span class="kbd">F</span> —Ñ–µ–π–∫, <span class="kbd">N</span> –¥–∞–ª—å—à–µ</div>
        <div>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ</div>
      </div>
    </div>

    <!-- –§–∏–Ω–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div class="card end" id="endCard" style="margin-top:14px;">
      <div class="end show">
        <div class="badge" id="resultBadge">–†–µ–∑—É–ª—å—Ç–∞—Ç</div>
        <h2 style="margin:10px 0 6px 0;">–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>
        <p style="margin:0; color:var(--muted)">
          –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω –Ω–∏–∂–µ ‚Äî –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –∫–∞—Ä—Ç–∏–Ω–∫—É –∏–ª–∏ —Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å.
        </p>

        <div class="controls" style="justify-content:center; margin-top:12px">
          <button class="primary" id="btnRestart">–°—ã–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
        </div>

        <div id="certWrap">
          <canvas id="certCanvas" width="900" height="600"></canvas>
          <div class="certBtns">
            <button class="primary" id="btnDownloadCert">–°–∫–∞—á–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç PNG</button>
            <button id="btnPrintCert">–ü–µ—á–∞—Ç—å</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TEACHER MODAL -->
  <div class="modalBack" id="modalBack" aria-hidden="true">
    <div class="modal">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap;">
        <h3>üë©‚Äçüè´ –†–µ–∂–∏–º —É—á–∏—Ç–µ–ª—è</h3>
        <div class="controls" style="margin:0">
          <button id="btnExport">–≠–∫—Å–ø–æ—Ä—Ç CSV</button>
          <button id="btnResetStats" class="warn">–°–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</button>
          <button class="primary" id="btnCloseModal">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
      </div>

      <div id="teacherGate" style="margin-top:10px">
        <div class="small" style="margin-bottom:8px">
          –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: <b>2026</b>. (–ú–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å –≤ –∫–æ–¥–µ: <b>TEACHER_PIN</b>)
        </div>
        <div class="controls">
          <div style="flex:1 1 260px; max-width:320px">
            <label for="pinInput">–ö–æ–¥</label>
            <input id="pinInput" type="password" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 2026" />
          </div>
          <div style="display:flex; align-items:flex-end">
            <button class="primary" id="btnPinOk">–í–æ–π—Ç–∏</button>
          </div>
        </div>
        <div class="small" id="pinMsg" style="margin-top:8px"></div>
      </div>

      <div id="teacherPanel" style="display:none; margin-top:10px">
        <div class="small">
          –ó–¥–µ—Å—å: –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤–µ—Ä–Ω–æ/–Ω–µ–≤–µ—Ä–Ω–æ/–ø—Ä–æ–ø—É—Å–∫) –ø–æ –∫–∞–∂–¥–æ–º—É –≤–æ–ø—Ä–æ—Å—É –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.
        </div>
        <table class="table" id="teacherTable"></table>
      </div>
    </div>
  </div>

<script>
  // ====== TEACHER SETTINGS ======
  const TEACHER_PIN = "2026";                 // <- –ø–æ–º–µ–Ω—è–π, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å
  const STATS_KEY = "safe_internet_stats_v4"; // —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

  // ====== ICONS for each question ======
  const icons = ["üîê","‚ö†Ô∏è","üîé","üõ°Ô∏è","üß©","‚òéÔ∏è","üì±","üì∞","üì∏","üö´"];

  // ====== QUESTIONS (Theme 1: Safe Internet) ======
  const questions = [
    {
      text: "–ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç ¬´–°–†–û–ß–ù–û –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–∞—Ä–æ–ª—å¬ª, —ç—Ç–æ –æ–±—ã—á–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫ —Ñ–∏—à–∏–Ω–≥–∞.",
      answer: true,
      explain: "–ú–æ—à–µ–Ω–Ω–∏–∫–∏ –¥–∞–≤—è—Ç —Å—Ä–æ—á–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ—Å—è—Ç –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —Å—Å—ã–ª–∫–µ/–≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ. –ù–∞—Å—Ç–æ—è—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã —Ä–µ–¥–∫–æ –ø—Ä–æ—Å—è—Ç –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –ø–∏—Å—å–º–∞.",
      hint: "–°—Ä–æ—á–Ω–æ—Å—Ç—å + —Å—Å—ã–ª–∫–∞ + –ø—Ä–æ—Å—å–±–∞ –æ –¥–∞–Ω–Ω—ã—Ö = –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫."
    },
    {
      text: "–ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞–º —Ñ–æ—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞, –µ—Å–ª–∏ –æ–Ω–∏ –æ–±–µ—â–∞—é—Ç ¬´–ø–æ–¥–∞—Ä–æ–∫/–ø—Ä–∏–∑/–≤—ã–ø–ª–∞—Ç—É¬ª.",
      answer: false,
      explain: "–≠—Ç–æ —á–∞—Å—Ç–∞—è —Å—Ö–µ–º–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞: –≤—ã–º–∞–Ω–∏–≤–∞—é—Ç –ò–ò–ù, –ø–∞—Å–ø–æ—Ä—Ç, —Ñ–æ—Ç–æ –∫–∞—Ä—Ç—ã. –î–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∏–∫–æ–º—É –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º.",
      hint: "–î–æ–∫—É–º–µ–Ω—Ç—ã –∏ –ò–ò–ù ‚Äî —Ç–æ–ª—å–∫–æ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è–º –∏ –ø–æ –∑–∞—â–∏—â—ë–Ω–Ω—ã–º –∫–∞–Ω–∞–ª–∞–º."
    },
    {
      text: "HTTPS (–∑–∞–º–æ—á–µ–∫) –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–∞–π—Ç —á–µ—Å—Ç–Ω—ã–π –Ω–∞ 100%.",
      answer: false,
      explain: "HTTPS —à–∏—Ñ—Ä—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ, –Ω–æ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∏–µ —Å–∞–π—Ç—ã —Ç–æ–∂–µ –º–æ–≥—É—Ç –∏–º–µ—Ç—å HTTPS. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∞–¥—Ä–µ—Å –∏ –∏—Å—Ç–æ—á–Ω–∏–∫.",
      hint: "HTTPS ‚Äî –ø—Ä–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ, –∞ –Ω–µ –ø—Ä–æ —á–µ—Å—Ç–Ω–æ—Å—Ç—å."
    },
    {
      text: "–î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA) –ø–æ–≤—ã—à–∞–µ—Ç –∑–∞—â–∏—Ç—É –∞–∫–∫–∞—É–Ω—Ç–∞ –¥–∞–∂–µ –ø—Ä–∏ —É—Ç–µ—á–∫–µ –ø–∞—Ä–æ–ª—è.",
      answer: true,
      explain: "2FA –¥–æ–±–∞–≤–ª—è–µ—Ç –≤—Ç–æ—Ä–æ–π —à–∞–≥: –∫–æ–¥/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ. –û–¥–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏.",
      hint: "2FA ‚Äî –≤—Ç–æ—Ä–æ–π –∑–∞–º–æ–∫ –Ω–∞ –¥–≤–µ—Ä–∏."
    },
    {
      text: "–û–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ ‚Äî –Ω–æ—Ä–º–∞–ª—å–Ω–æ.",
      answer: false,
      explain: "–ï—Å–ª–∏ –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å –≤–∑–ª–æ–º–∞—é—Ç, –ø–æ—Å—Ç—Ä–∞–¥–∞—é—Ç –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã. –ù—É–∂–Ω—ã —Ä–∞–∑–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –∏–ª–∏ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π.",
      hint: "–û–¥–∏–Ω –ø–∞—Ä–æ–ª—å –Ω–∞ –≤—Å—ë = –æ–¥–∏–Ω –∫–ª—é—á –æ—Ç –≤—Å–µ—Ö –¥–≤–µ—Ä–µ–π."
    },
    {
      text: "–ï—Å–ª–∏ –≤–∞–º –ø–∏—à—É—Ç ¬´—ç—Ç–æ —Ç–≤–æ–π —É—á–∏—Ç–µ–ª—å/–¥–∏—Ä–µ–∫—Ç–æ—Ä, —Å—Ä–æ—á–Ω–æ –ø–µ—Ä–µ–≤–µ–¥–∏ –¥–µ–Ω—å–≥–∏¬ª, –Ω—É–∂–Ω–æ —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ –¥—Ä—É–≥–æ–º—É –∫–∞–Ω–∞–ª—É.",
      answer: true,
      explain: "–ú–æ—à–µ–Ω–Ω–∏–∫–∏ –ø–æ–¥–¥–µ–ª—ã–≤–∞—é—Ç –∞–∫–∫–∞—É–Ω—Ç—ã. –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç–µ/—Å–ø—Ä–æ—Å–∏—Ç–µ –ª–∏—á–Ω–æ/—á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —á–∞—Ç.",
      hint: "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –≤—Ç–æ—Ä–æ–º—É –∫–∞–Ω–∞–ª—É ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞."
    },
    {
      text: "–õ–∏—à–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–∫–æ–Ω—Ç–∞–∫—Ç—ã/–º–∏–∫—Ä–æ—Ñ–æ–Ω –±–µ–∑ –ø—Ä–∏—á–∏–Ω—ã) ‚Äî –ø–æ–≤–æ–¥ –Ω–∞—Å—Ç–æ—Ä–æ–∂–∏—Ç—å—Å—è.",
      answer: true,
      explain: "–†–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—è–º. –õ–∏—à–Ω–∏–µ –¥–æ—Å—Ç—É–ø—ã = –≤–æ–∑–º–æ–∂–Ω—ã–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö.",
      hint: "–î–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Ç–æ–ª—å–∫–æ —Ç–æ, —á—Ç–æ –Ω—É–∂–Ω–æ."
    },
    {
      text: "–ï—Å–ª–∏ –≤ –Ω–æ–≤–æ—Å—Ç–∏ –Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏ –µ—ë –æ–ø—É–±–ª–∏–∫–æ–≤–∞–ª –æ–¥–∏–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–Ω–∞–ª, –ª—É—á—à–µ –ø–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ–±—ã ¬´–±—ã—Ç—å –≤ –∫—É—Ä—Å–µ¬ª.",
      answer: false,
      explain: "–≠—Ç–æ —Ä–∏—Å–∫. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –º–∏–Ω–∏–º—É–º –ø–æ 2‚Äì3 –Ω–∞–¥—ë–∂–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º, –∏—â–∏—Ç–µ –ø–µ—Ä–≤–æ–∏—Å—Ç–æ—á–Ω–∏–∫.",
      hint: "–ü—Ä–∞–≤–∏–ª–æ: 2‚Äì3 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞."
    },
    {
      text: "–ü–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ—Ç –ª–∏ –Ω–∞ —Ñ–æ–Ω–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–Ω–æ–º–µ—Ä, –¥–æ–∫—É–º–µ–Ω—Ç—ã, –∞–¥—Ä–µ—Å).",
      answer: true,
      explain: "–ù–∞ —Ñ–æ—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∏–¥–µ–Ω –∞–¥—Ä–µ—Å, –¥–æ–∫—É–º–µ–Ω—Ç—ã, —ç–∫—Ä–∞–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞. –≠—Ç–æ —Ä–∏—Å–∫ —É—Ç–µ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö.",
      hint: "–î—É–º–∞–π, —á—Ç–æ ¬´—Å–ª—É—á–∞–π–Ω–æ¬ª –≤–∏–¥–Ω–æ –Ω–∞ –∫–∞–¥—Ä–µ."
    },
    {
      text: "–ï—Å–ª–∏ –≤—ã —Å–æ–º–Ω–µ–≤–∞–µ—Ç–µ—Å—å –≤ —Å—Å—ã–ª–∫–µ, –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ –æ—Ç–∫—Ä—ã—Ç—å –µ—ë —Å—Ä–∞–∑—É ‚Äî ¬´–Ω—É –≤–¥—Ä—É–≥ —Ç–∞–º –≤–∞–∂–Ω–æ¬ª.",
      answer: false,
      explain: "–õ—É—á—à–µ –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–¥—Ä–µ—Å, —Å–ø—Ä–æ—Å–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∞–π—Ç—ã –∏ –ø–æ–∏—Å–∫.",
      hint: "–°–æ–º–Ω–µ–≤–∞–µ—à—å—Å—è ‚Äî –Ω–µ –∫–ª–∏–∫–∞–π."
    }
  ];

  // ====== Helpers ======
  const $ = (id) => document.getElementById(id);
  function escapeHtml(s){
    return s.replace(/[&<>"']/g, (c) => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  // ====== Stats (local on this device) ======
  function defaultStats(){ return questions.map(() => ({ correct:0, wrong:0, skip:0 })); }
  function loadStats(){
    const raw = localStorage.getItem(STATS_KEY);
    if (!raw) return defaultStats();
    try{
      const parsed = JSON.parse(raw);
      if (!Array.isArray(parsed) || parsed.length !== questions.length) return defaultStats();
      return parsed;
    }catch{
      return defaultStats();
    }
  }
  function saveStats(s){ localStorage.setItem(STATS_KEY, JSON.stringify(s)); }
  let stats = loadStats();

  // ====== Game state ======
  let idx = 0;
  let score = 0;
  let locked = false;
  let playerName = "";

  // ====== UI refs ======
  const nameCard = $("nameCard");
  const nameInput = $("nameInput");
  const btnStart = $("btnStart");

  const gameCard = $("gameCard");
  const endCard = $("endCard");
  const certWrap = $("certWrap");
  const certCanvas = $("certCanvas");
  const btnDownloadCert = $("btnDownloadCert");
  const btnPrintCert = $("btnPrintCert");

  const statQ = $("statQ"), statScore = $("statScore"), qno = $("qno"), question = $("question"), bar = $("bar");
  const qIconQ = $("qIconQ");
  const btnTruth = $("btnTruth"), btnFake = $("btnFake"), btnSkip = $("btnSkip"), btnNext = $("btnNext");
  const feedback = $("feedback"), fbLabel = $("fbLabel"), fbText = $("fbText");
  const hint = $("hint"), hintText = $("hintText");
  const resultBadge = $("resultBadge"), btnRestart = $("btnRestart");

  function startGame(){
    const n = (nameInput.value || "").trim();
    playerName = n ? n : "–£—á–∞—Å—Ç–Ω–∏–∫";
    nameCard.style.display = "none";
    gameCard.style.display = "block";
    endCard.classList.remove("show");
    render();
  }

  function render(){
    const total = questions.length;
    const q = questions[idx];

    statQ.textContent = `${idx + 1}/${total}`;
    qno.textContent = `–í–æ–ø—Ä–æ—Å ${idx + 1} –∏–∑ ${total}`;
    question.textContent = q.text;
    bar.style.width = `${(idx / total) * 100}%`;

    qIconQ.textContent = icons[idx] || "üîê";

    feedback.className = "feedback";
    feedback.style.display = "none";
    hint.className = "hint";
    hintText.textContent = q.hint || "";

    // —Å–Ω—è—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã
    gameCard.classList.remove("correct","wrong");

    locked = false;
    btnTruth.disabled = false;
    btnFake.disabled = false;
    btnSkip.disabled = false;
    btnNext.disabled = true;
  }

  function lockButtons(){
    btnTruth.disabled = true;
    btnFake.disabled = true;
    btnSkip.disabled = true;
    btnNext.disabled = false;
  }

  function answer(userAns){
    if (locked) return;
    locked = true;

    const q = questions[idx];
    const correct = (userAns === q.answer);

    // ‚úÖ‚ùå –≤–∏–∑—É–∞–ª—å–Ω–∞—è —Ä–µ–∞–∫—Ü–∏—è
    gameCard.classList.remove("correct","wrong");
    gameCard.classList.add(correct ? "correct" : "wrong");

    if (correct) score += 1;
    statScore.textContent = String(score);

    // stats
    if (correct) stats[idx].correct += 1;
    else stats[idx].wrong += 1;
    saveStats(stats);

    feedback.style.display = "block";
    feedback.classList.add("show", correct ? "good" : "bad");
    fbLabel.textContent = correct ? "–í–µ—Ä–Ω–æ ‚úÖ" : "–ù–µ–≤–µ—Ä–Ω–æ ‚ùå";
    fbText.innerHTML = `
      <div><strong>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</strong> ${q.answer ? "–ü—Ä–∞–≤–¥–∞" : "–§–µ–π–∫"}</div>
      <div style="margin-top:6px">${q.explain}</div>
    `;

    hint.classList.add("show");
    lockButtons();
    bar.style.width = `${((idx + 1) / questions.length) * 100}%`;
  }

  function skip(){
    if (locked) return;
    locked = true;

    gameCard.classList.remove("correct","wrong");

    stats[idx].skip += 1;
    saveStats(stats);

    feedback.style.display = "block";
    feedback.classList.add("show");
    fbLabel.textContent = "–ü—Ä–æ–ø—É—â–µ–Ω–æ ‚è≠Ô∏è";
    fbText.innerHTML = `<div>${questions[idx].explain}</div>`;
    hint.classList.add("show");

    lockButtons();
    bar.style.width = `${((idx + 1) / questions.length) * 100}%`;
  }

  function next(){
    if (idx < questions.length - 1){
      idx += 1;
      render();
    } else {
      finish();
    }
  }

  function finish(){
    gameCard.style.display = "none";
    endCard.classList.add("show");

    const total = questions.length;
    const pct = Math.round((score / total) * 100);

    let level = "–ù–æ–≤–∏—á–æ–∫";
    let title = "–ö–∏–±–µ—Ä-—É—á–µ–Ω–∏–∫";
    if (pct >= 80){ level = "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π"; title = "–ö–∏–±–µ—Ä-–∑–∞—â–∏—Ç–Ω–∏–∫ üõ°Ô∏è"; }
    else if (pct >= 60){ level = "–£–≤–µ—Ä–µ–Ω–Ω—ã–π"; title = "–ö–∏–±–µ—Ä-–Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å üëÄ"; }
    else { level = "–ù–∞—á–∞–ª—å–Ω—ã–π"; title = "–ö–∏–±–µ—Ä-—Å—Ç–∞–∂—ë—Ä ‚ö†Ô∏è"; }

    resultBadge.textContent = `–†–µ–∑—É–ª—å—Ç–∞—Ç: ${score}/${total} (${pct}%) ‚Ä¢ ${title}`;

    // –ø–æ–∫–∞–∑–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç
    certWrap.classList.add("show");
    generateCertificate(playerName, title, `${score}/${total} (${pct}%)`);
  }

  function restart(){
    idx = 0;
    score = 0;
    locked = false;
    statScore.textContent = "0";
    certWrap.classList.remove("show");
    endCard.classList.remove("show");
    gameCard.style.display = "none";
    nameCard.style.display = "block";
    nameInput.value = playerName === "–£—á–∞—Å—Ç–Ω–∏–∫" ? "" : playerName;
    nameInput.focus();
  }

  btnTruth.addEventListener("click", () => answer(true));
  btnFake.addEventListener("click", () => answer(false));
  btnSkip.addEventListener("click", skip);
  btnNext.addEventListener("click", next);
  btnRestart.addEventListener("click", restart);

  document.addEventListener("keydown", (e) => {
    const k = e.key.toLowerCase();
    if (nameCard.style.display !== "none"){
      if (k === "enter") startGame();
    } else if (gameCard.style.display !== "none"){
      if (k === "t") answer(true);
      if (k === "f") answer(false);
      if (k === "n" && !btnNext.disabled) next();
    }
  });

  btnStart.addEventListener("click", startGame);

  // ====== CERTIFICATE (Canvas -> PNG) ======
  function generateCertificate(name, title, resultText){
    const c = certCanvas;
    const ctx = c.getContext("2d");

    // background
    ctx.fillStyle = "#0f1221";
    ctx.fillRect(0,0,c.width,c.height);

    // gradients
    const g1 = ctx.createRadialGradient(220,160,10,220,160,420);
    g1.addColorStop(0,"rgba(124,92,255,.35)");
    g1.addColorStop(1,"rgba(124,92,255,0)");
    ctx.fillStyle = g1;
    ctx.fillRect(0,0,c.width,c.height);

    const g2 = ctx.createRadialGradient(700,140,10,700,140,420);
    g2.addColorStop(0,"rgba(79,213,255,.22)");
    g2.addColorStop(1,"rgba(79,213,255,0)");
    ctx.fillStyle = g2;
    ctx.fillRect(0,0,c.width,c.height);

    // frame
    ctx.strokeStyle = "#7c5cff";
    ctx.lineWidth = 10;
    ctx.strokeRect(24,24,c.width-48,c.height-48);

    ctx.strokeStyle = "rgba(255,255,255,.18)";
    ctx.lineWidth = 2;
    ctx.strokeRect(44,44,c.width-88,c.height-88);

    // header
    ctx.textAlign = "center";
    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 52px Arial";
    ctx.fillText("–°–ï–†–¢–ò–§–ò–ö–ê–¢", c.width/2, 130);

    ctx.fillStyle = "#b8bce6";
    ctx.font = "22px Arial";
    ctx.fillText("–≤—ã–¥–∞–Ω –∑–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –≤–µ–±-–∏–≥—Ä—ã", c.width/2, 175);
    ctx.fillStyle = "#f2f4ff";
    ctx.font = "bold 30px Arial";
    ctx.fillText("¬´–ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç¬ª", c.width/2, 215);

    // name
    ctx.fillStyle = "#b8bce6";
    ctx.font = "22px Arial";
    ctx.fillText("–£—á–∞—Å—Ç–Ω–∏–∫:", c.width/2, 280);

    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 44px Arial";
    ctx.fillText(name, c.width/2, 335);

    // title
    ctx.fillStyle = "#7c5cff";
    ctx.font = "bold 30px Arial";
    ctx.fillText(title, c.width/2, 390);

    // result
    ctx.fillStyle = "#b8bce6";
    ctx.font = "20px Arial";
    ctx.fillText(`–†–µ–∑—É–ª—å—Ç–∞—Ç: ${resultText}`, c.width/2, 430);

    // footer
    const dt = new Date();
    const dateText = dt.toLocaleDateString("ru-RU");
    ctx.fillStyle = "rgba(242,244,255,.85)";
    ctx.font = "18px Arial";
    ctx.fillText(`Smart Bala ‚Ä¢ ${dateText}`, c.width/2, 510);

    ctx.fillStyle = "rgba(184,188,230,.85)";
    ctx.font = "16px Arial";
    ctx.fillText("–®–∫–æ–ª–∞: _______________________   –ü–æ–¥–ø–∏—Å—å: _______________________", c.width/2, 548);
  }

  function downloadCertificate(){
    const url = certCanvas.toDataURL("image/png");
    const a = document.createElement("a");
    a.href = url;
    a.download = `certificate_${(playerName || "—É—á–∞—Å—Ç–Ω–∏–∫").replace(/\s+/g,"_")}.png`;
    a.click();
  }

  function printCertificate(){
    const dataUrl = certCanvas.toDataURL("image/png");
    const w = window.open("");
    w.document.write(`<img src="${dataUrl}" style="width:100%;max-width:1000px">`);
    w.document.close();
    w.focus();
    w.print();
  }

  btnDownloadCert.addEventListener("click", downloadCertificate);
  btnPrintCert.addEventListener("click", printCertificate);

  // ====== TEACHER MODE ======
  const btnTeacher = $("btnTeacher");
  const modalBack = $("modalBack");
  const btnCloseModal = $("btnCloseModal");
  const teacherGate = $("teacherGate");
  const teacherPanel = $("teacherPanel");
  const pinInput = $("pinInput");
  const btnPinOk = $("btnPinOk");
  const pinMsg = $("pinMsg");
  const teacherTable = $("teacherTable");
  const btnResetStats = $("btnResetStats");
  const btnExport = $("btnExport");

  function openTeacher(){
    modalBack.classList.add("show");
    modalBack.setAttribute("aria-hidden","false");
    teacherGate.style.display = "block";
    teacherPanel.style.display = "none";
    pinInput.value = "";
    pinMsg.textContent = "";
    pinInput.focus();
  }

  function closeTeacher(){
    modalBack.classList.remove("show");
    modalBack.setAttribute("aria-hidden","true");
  }

  function buildTeacherTable(){
    stats = loadStats();
    const head = `
      <tr>
        <th>#</th>
        <th>–í–æ–ø—Ä–æ—Å</th>
        <th>–û—Ç–≤–µ—Ç</th>
        <th>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</th>
        <th>–û–±—ä—è—Å–Ω–µ–Ω–∏–µ</th>
      </tr>
    `;
    const rows = questions.map((q, i) => {
      const s = stats[i] || {correct:0, wrong:0, skip:0};
      const ans = q.answer ? `<span class="tag good">–ü—Ä–∞–≤–¥–∞</span>` : `<span class="tag bad">–§–µ–π–∫</span>`;
      const st = `‚úÖ ${s.correct} &nbsp; ‚ùå ${s.wrong} &nbsp; ‚è≠Ô∏è ${s.skip}`;
      return `
        <tr>
          <td>${i+1}</td>
          <td>${escapeHtml(q.text)}</td>
          <td>${ans}</td>
          <td>${st}</td>
          <td>${escapeHtml(q.explain)}</td>
        </tr>
      `;
    }).join("");
    teacherTable.innerHTML = head + rows;
  }

  function teacherLogin(){
    const pin = (pinInput.value || "").trim();
    if (pin === TEACHER_PIN){
      teacherGate.style.display = "none";
      teacherPanel.style.display = "block";
      buildTeacherTable();
    } else {
      pinMsg.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.";
      pinMsg.style.color = "rgba(255,92,122,.95)";
      pinInput.focus();
    }
  }

  function resetStats(){
    if (!confirm("–°–±—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —ç—Ç–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ?")) return;
    stats = defaultStats();
    saveStats(stats);
    buildTeacherTable();
    alert("–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–±—Ä–æ—à–µ–Ω–∞ ‚úÖ");
  }

  function exportCSV(){
    stats = loadStats();
    const lines = [];
    lines.push(["‚Ññ","–í–æ–ø—Ä–æ—Å","–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç","–í–µ—Ä–Ω–æ","–ù–µ–≤–µ—Ä–Ω–æ","–ü—Ä–æ–ø—É—Å–∫"].join(";"));
    questions.forEach((q, i) => {
      const s = stats[i] || {correct:0, wrong:0, skip:0};
      const row = [
        String(i+1),
        `"${q.text.replace(/"/g,'""')}"`,
        q.answer ? "–ü—Ä–∞–≤–¥–∞" : "–§–µ–π–∫",
        String(s.correct),
        String(s.wrong),
        String(s.skip)
      ];
      lines.push(row.join(";"));
    });
    const blob = new Blob([lines.join("\n")], {type:"text/csv;charset=utf-8;"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "internet_safety_stats.csv";
    a.click();
    URL.revokeObjectURL(url);
  }

  btnTeacher.addEventListener("click", openTeacher);
  btnCloseModal.addEventListener("click", closeTeacher);
  modalBack.addEventListener("click", (e) => { if (e.target === modalBack) closeTeacher(); });
  btnPinOk.addEventListener("click", teacherLogin);
  pinInput.addEventListener("keydown", (e) => { if (e.key === "Enter") teacherLogin(); });
  btnResetStats.addEventListener("click", resetStats);
  btnExport.addEventListener("click", exportCSV);

  // ====== INIT ======
  // –ø–æ–∫–∞–∑–∞—Ç—å —ç–∫—Ä–∞–Ω –∏–º–µ–Ω–∏ –∏ —Ñ–æ–∫—É—Å
  nameInput.focus();
</script>
</body>
</html>
```
